/* jQuery Bracket | Copyright (c) Teijo Laine 2011-2020 | Licenced under the MIT licence */

var EntryState,__assign=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};!function(t){t.EMPTY_BYE="empty-bye",t.EMPTY_TBD="empty-tbd",t.ENTRY_NO_SCORE="entry-no-score",t.ENTRY_DEFAULT_WIN="entry-default-win",t.ENTRY_COMPLETE="entry-complete"}(EntryState||(EntryState={})),function(C){var E,t,w=function(){function e(t){if((this.val=t)instanceof e)throw new Error("Trying to wrap Option into an Option");if(void 0===this.val)throw new Error("Option cannot contain undefined")}return e.of=function(t){return new e(t)},e.empty=function(){return new e(null)},e.prototype.get=function(){if(null===this.val)throw new Error("Trying to get() empty Option");return this.val},e.prototype.orElse=function(t){return null===this.val?t:this.val},e.prototype.orElseGet=function(t){return null===this.val?t():this.val},e.prototype.map=function(t){return null===this.val?e.empty():new e(t(this.val))},e.prototype.forEach=function(t){return null!==this.val&&t(this.val),this},e.prototype.toNull=function(){return null===this.val?null:this.val},e.prototype.isEmpty=function(){return null===this.val},e}(),o=function(t,e,n){if(this.first=t,this.second=e,this.matchData=n,!t||!e)throw new Error("Cannot create ResultObject with undefined scores")};(t=E||(E={}))[t.TBD=0]="TBD",t[t.BYE=1]="BYE",t[t.END=2]="END";var l=function(){function t(t){this.isFirst=t}return t.first=function(){return new t(!0)},t.second=function(){return new t(!1)},t.prototype.map=function(t,e){return this.isFirst?t:e},t}(),d=function(){function t(t,e,n,r,i){this.source=t,this.nameOrGetter=e,this.order=n,this.seed=r,this.score=i,this.sibling=function(){throw new Error("No sibling asigned")}}return Object.defineProperty(t.prototype,"name",{get:function(){return"function"==typeof this.nameOrGetter?this.nameOrGetter():this.nameOrGetter},set:function(t){this.nameOrGetter=t},enumerable:!0,configurable:!0}),t.prototype.emptyBranch=function(){if(!this.name.isEmpty())return this.sibling().name.isEmpty()?E.BYE:E.TBD;try{var t=this.source().emptyBranch();return t===E.TBD?E.TBD:t===E.END?E.BYE:this.source().sibling().emptyBranch()===E.TBD?E.TBD:E.BYE}catch(t){if(t instanceof e)return E.END;throw new Error('Unexpected exception type (message: "'+t.message+'")')}},t}();function k(t){return!isNaN(parseFloat(t))&&isFinite(t)}function e(){this.message="Root of information for this team",this.name="EndOfBranchException"}var p=function(){function t(t,e){this.a=t,this.b=e}return t.teamsInResultOrder=function(t){var e=t.a.name.isEmpty(),n=t.b.name.isEmpty();if(n&&!e)return t.b.emptyBranch()===E.BYE?[t.a,t.b]:[];if(e&&!n)return t.a.emptyBranch()===E.BYE?[t.b,t.a]:[];if(!t.a.score.isEmpty()&&!t.b.score.isEmpty()){if(t.a.score.get()>t.b.score.get())return[t.a,t.b];if(t.a.score.get()<t.b.score.get())return[t.b,t.a]}return[]},t.emptyTeam=function(t,e){var n=new d(t,w.empty(),w.empty(),w.empty(),w.empty());return n.sibling=function(){return e},n},t.prototype.winner=function(){return t.teamsInResultOrder(this)[0]||t.emptyTeam(this.a.source,this.b)},t.prototype.loser=function(){return t.teamsInResultOrder(this)[1]||t.emptyTeam(this.b.source,this.a)},t}();function m(t,e,n){var r=n.find(".team[data-teamid="+t+"]"),i=e||"highlight";return{highlight:function(){r.each(function(){C(this).addClass(i),C(this).hasClass("win")&&C(this).parent().find(".connector").addClass(i)})},deHighlight:function(){r.each(function(){C(this).removeClass(i),C(this).parent().find(".connector").removeClass(i)})}}}function r(t,e,n){var r=C('<input type="text">');r.val(e),t.empty().append(r),r.focus(),r.blur(function(){n(r.val())}),r.keydown(function(t){var e=t.keyCode||t.which;9!==e&&13!==e&&27!==e||(t.preventDefault(),n(r.val(),27!==e))})}function i(t,e,n,r){switch(r){case EntryState.EMPTY_BYE:return void t.append("BYE");case EntryState.EMPTY_TBD:return void t.append("TBD");case EntryState.ENTRY_NO_SCORE:case EntryState.ENTRY_DEFAULT_WIN:case EntryState.ENTRY_COMPLETE:return void t.append(e)}}function g(t){var e=t.el;return e.find(".team.win").append('<div class="bubble">1st</div>'),e.find(".team.lose").append('<div class="bubble">2nd</div>'),!0}function v(t){var e=t.el;return e.find(".team.win").append('<div class="bubble third">3rd</div>'),e.find(".team.lose").append('<div class="bubble fourth">4th</div>'),!0}var s=function(){throw new e},b=function(n,r){return function(){var t=new d(s,function(){return n[r][0]},w.of(l.first()),w.of(2*r),w.empty()),e=new d(s,function(){return n[r][1]},w.of(l.second()),w.of(2*r+1),w.empty());return t.sibling=function(){return e},e.sibling=function(){return t},[{source:function(){return t}},{source:function(){return e}}]}},y=function(n,r){return function(t){t.css("top","");var e=t.height();t.css({bottom:r?"":-e/2+"px",position:"absolute",top:r?n.el.height()/2-e/2+"px":""})}};var T=function(e,n,r,i,o,s){return function(){if(o%2==0&&0===s)return[{source:function(){return e.round(0).match(2*i).loser()}},{source:function(){return e.round(0).match(2*i+1).loser()}}];var t=s%2==0?r-i-1:i;return[{source:function(){return n.round(2*s).match(i).winner()}},{source:function(){return e.round(s+1).match(t).loser()}}]}},M=function(e,n){return function(){var t=n.el.height()/2-e.height()/2;return e.css({top:t})}},R=function(i){return function(t,e){var n=t.height()/4,r={height:0,shift:2*n};return e.winner().order.map(function(t){return t.map(i?r:{height:0,shift:n},i?r:{height:2*-n,shift:n})}).orElse(r)}};var a=function(){function t(t,e,n,r,i,o,s,a){this.bracket=t,this.previousRound=e,this.roundNumber=n,this.roundResults=r,this.doRenderCb=i,this.mkMatch=o,this.isFirstBracket=s,this.opts=a,this.containerWidth=this.opts.teamWidth+this.opts.scoreWidth,this.roundCon=C('<div class="round" style="width: '+this.containerWidth+"px; margin-right: "+this.opts.roundMargin+'px"/>'),this.matches=[]}return Object.defineProperty(t.prototype,"el",{get:function(){return this.roundCon},enumerable:!0,configurable:!0}),t.prototype.addMatch=function(t,e){var n=this,r=this.matches.length,i=null!==t?t():[{source:function(){return n.bracket.round(n.roundNumber-1).match(2*r).winner()}},{source:function(){return n.bracket.round(n.roundNumber-1).match(2*r+1).winner()}}],o=function(){return i[0].source()},s=function(){return i[1].source()},a=new d(o,o().name,w.of(l.first()),o().seed,w.empty()),c=new d(s,s().name,w.of(l.second()),s().seed,w.empty());a.sibling=function(){return c},c.sibling=function(){return a};var h=new p(a,c),u=this.mkMatch(this,h,r,this.roundResults.map(function(t){return void 0===t[r]?null:t[r]}),e,this.isFirstBracket,this.opts);return this.matches.push(u),u},t.prototype.match=function(t){return this.matches[t]},t.prototype.prev=function(){return this.previousRound},t.prototype.size=function(){return this.matches.length},t.prototype.render=function(){this.roundCon.empty(),(this.doRenderCb.isEmpty()||this.doRenderCb.get()())&&(this.roundCon.appendTo(this.bracket.el),this.matches.forEach(function(t){return t.render()}))},t.prototype.results=function(){return this.matches.reduce(function(t,e){return t.concat([e.results()])},[])},t}(),N=function(){function t(t,e,n,r,i){this.bracketCon=t,this.initResults=e,this.mkMatch=n,this.isFirstBracket=r,this.opts=i,this.rounds=[]}return Object.defineProperty(t.prototype,"el",{get:function(){return this.bracketCon},enumerable:!0,configurable:!0}),t.prototype.addRound=function(t){var e=this.rounds.length,n=0<e?w.of(this.rounds[e-1]):w.empty(),r=this.initResults.map(function(t){return void 0===t[e]?new o(w.empty(),w.empty(),void 0):t[e]}),i=new a(this,n,e,r,t,this.mkMatch,this.isFirstBracket,this.opts);return this.rounds.push(i),i},t.prototype.dropRound=function(){this.rounds.pop()},t.prototype.round=function(t){return this.rounds[t]},t.prototype.size=function(){return this.rounds.length},t.prototype.final=function(){return this.rounds[this.rounds.length-1].match(0)},t.prototype.winner=function(){return this.rounds[this.rounds.length-1].match(0).winner()},t.prototype.loser=function(){return this.rounds[this.rounds.length-1].match(0).loser()},t.prototype.render=function(){this.bracketCon.empty();for(var t=0,e=this.rounds;t<e.length;t++){e[t].render()}},t.prototype.results=function(){return this.rounds.reduce(function(t,e){return t.concat([e.results()])},[])},t}();function B(t){var e=C.extend(!0,{},t);return e.teams=e.teams.map(function(t){return t.map(function(t){return t.toNull()})}),e.results=e.results.map(function(t){return t.map(function(t){return t.map(function(t){return void 0!==t.matchData?[t.first.toNull(),t.second.toNull(),t.matchData]:[t.first.toNull(),t.second.toNull()]})})}),e}var O=function(){function t(){this.counter=0}return t.prototype.get=function(){return this.counter},t.prototype.getNext=function(){return++this.counter},t.prototype.reset=function(){this.counter=0},t}();function c(s,t,a,e,n,r,c,i,o,h){var u=a.name.isEmpty()||e.name.isEmpty()?"":'data-resultid="result-'+i.getNext()+'"',l=C('<div class="score" style="width: '+c.scoreWidth+'px;" '+u+"></div>"),d=a.name.isEmpty()||e.name.isEmpty()||!n?w.empty():a.score,p=c.extension.scoreToString(d.toNull());l.text(p);var f,m,g,v=C('<div class="team" style="width: '+(c.teamWidth+c.scoreWidth)+'px;"></div>'),b=C('<div class="label" style="width: '+c.teamWidth+'px;"></div>').appendTo(v);if(c.decorator.render(b,a.name.toNull(),a.score.toNull(),(m=e,g=(f=a).score,f.name.map(function(){return g.map(function(){return EntryState.ENTRY_COMPLETE}).orElseGet(function(){return m.emptyBranch()===E.BYE?EntryState.ENTRY_DEFAULT_WIN:EntryState.ENTRY_NO_SCORE})}).orElseGet(function(){var t=f.emptyBranch();switch(t){case E.BYE:return EntryState.EMPTY_BYE;case E.TBD:return EntryState.EMPTY_TBD;default:throw new Error("Unexpected branch type "+t)}}))),a.seed.forEach(function(t){v.attr("data-teamid",t)}),a.name.isEmpty()?v.addClass("na"):t.winner().name===a.name?v.addClass("win"):t.loser().name===a.name&&v.addClass("lose"),v.append(l),(!a.name.isEmpty()||a.name.isEmpty()&&0===s&&r)&&"function"==typeof c.save&&(c.disableTeamEdit||(b.addClass("editable"),b.click(function(){var o=C(this);!function i(){o.unbind(),c.decorator.edit(o,a.name.toNull(),function(t,e){var n=a.seed.get();c.init.teams[~~(n/2)][n%2]=w.of(t||null),h(!0),o.click(i);var r=c.el.find(".team[data-teamid="+(n+1)+"] div.label:first");r.length&&!0===e&&0===s&&C(r).click()})}()})),!a.name.isEmpty()&&!e.name.isEmpty()&&n)){var y=i.get();l.addClass("editable"),l.click(function(){var r=C(this);!function e(){r.unbind();var t=k(a.score)?r.text():"0",n=C('<input type="text">');n.val(t),r.empty().append(n),n.focus().select(),n.keydown(function(t){k(C(this).val())?C(this).removeClass("error"):C(this).addClass("error");var e=t.keyCode||t.which;if(9===e||13===e||27===e){if(t.preventDefault(),C(this).blur(),27===e)return;var n=o.find("div.score[data-resultid=result-"+(y+1)+"]");n&&n.click()}}),n.blur(function(){var t=c.extension.evaluateScore(n.val(),a.score.toNull());null===t&&(t=a.score),r.html(t),k(t)&&(a.score=w.of(t),h(!0)),r.click(e)})}()})}return v}var D=function(){function t(t,e,n,r,i,o,s,a,c,h){if(this.round=t,this.match=e,this.seed=n,this.renderCb=i,this.isFirstBracket=o,this.opts=s,this.resultId=a,this.topCon=c,this.renderAll=h,this.connectorCb=w.empty(),this.matchCon=C('<div class="match"></div>'),this.teamCon=C('<div class="teamContainer"></div>'),this.alignCb=null,this.matchUserData=r.isEmpty()?void 0:r.get().matchData,!s.save){var u=this.matchUserData;this.teamCon.hover(function(){s.onMatchHover(u,!0)},function(){s.onMatchHover(u,!1)}),this.teamCon.click(function(){s.onMatchClick(u)})}e.a.name=e.a.source().name,e.b.name=e.b.source().name,e.a.score=r.map(function(t){return t.first.toNull()}),e.b.score=r.map(function(t){return t.second.toNull()}),e.a.name&&e.b.name||!k(e.a.score)&&!k(e.b.score)||(console.warn("ERROR IN SCORE DATA: "+e.a.source().name+": "+e.a.score+", "+e.b.source().name+": "+e.b.score),e.a.score=e.b.score=w.empty())}return Object.defineProperty(t.prototype,"el",{get:function(){return this.matchCon},enumerable:!0,configurable:!0}),t.prototype.getRound=function(){return this.round},t.prototype.setConnectorCb=function(t){this.connectorCb=t},t.prototype.connect=function(t){var e,n,r,i,o,s,a,c,h,u,l,d,p,f,m=this,g="lr"===this.opts.dir?"right":"left",v=this.teamCon.height()/4,b=this.matchCon.height()/2,y=t.map(function(t){return t(m.teamCon,m)}).orElseGet(function(){return m.seed%2==0?m.winner().order.map(function(t){return t.map({height:b,shift:v*(m.opts.centerConnectors?2:1)},{height:b-v*(m.opts.centerConnectors?0:2),shift:v*(m.opts.centerConnectors?2:3)})}).orElse({height:b-v*(m.opts.centerConnectors?0:1),shift:2*v}):m.winner().order.map(function(t){return t.map({height:-b+v*(m.opts.centerConnectors?0:2),shift:-v*(m.opts.centerConnectors?2:3)},{height:-b,shift:-v*(m.opts.centerConnectors?2:1)})}).orElse({height:-b+v*(m.opts.centerConnectors?0:1),shift:2*-v})});this.teamCon.append((e=this.opts.roundMargin,r=g,a=(n=y).shift,c=(s=n.height)<0?{height:-s,drop:!1}:s<2?{height:0,drop:!0}:{height:s,drop:!0},h=c.height,u=c.drop,l=e/2,d=0<=a,p=C('<div class="connector"></div>').css(((i={})[r]=-l-2,i.borderBottom=u?"none":"",i.borderTop=u?"":"none",i.bottom=d?"":-a-1,i.height=h,i.top=d?a-1:"",i.width=l,i)),f=C('<div class="connector"></div>').css(((o={})[r]=-l,o.bottom=u?0:"",o.top=u?"":0,o.width=l,o)),p.append(f)))},t.prototype.winner=function(){return this.match.winner()},t.prototype.loser=function(){return this.match.loser()},t.prototype.first=function(){return this.match.a},t.prototype.second=function(){return this.match.b},t.prototype.setAlignCb=function(t){this.alignCb=t},t.prototype.render=function(){var e=this;this.matchCon.empty(),this.teamCon.empty(),this.match.a.name=this.match.a.source().name,this.match.b.name=this.match.b.source().name,this.match.a.seed=this.match.a.source().seed,this.match.b.seed=this.match.b.source().seed,this.match.a.name.isEmpty()&&this.match.b.name.isEmpty()?this.teamCon.addClass("np"):this.match.winner().name?this.teamCon.removeClass("np"):this.teamCon.addClass("np");var t=!this.match.a.name.isEmpty()&&!this.match.b.name.isEmpty();this.teamCon.append(c(this.round.roundNumber,this.match,this.match.a,this.match.b,t,this.isFirstBracket,this.opts,this.resultId,this.topCon,this.renderAll)),this.teamCon.append(c(this.round.roundNumber,this.match,this.match.b,this.match.a,t,this.isFirstBracket,this.opts,this.resultId,this.topCon,this.renderAll)),this.matchCon.appendTo(this.round.el),this.matchCon.append(this.teamCon);var n=this.round.bracket.el.height()/this.round.size();this.el.css({height:n});var r=this.el.height()/2-this.teamCon.height()/2;this.teamCon.css({top:r}),null!==this.alignCb&&this.alignCb(this.teamCon),this.renderCb.map(function(t){return t(e)}).orElse(!1)||this.connect(this.connectorCb)},t.prototype.results=function(){return(this.match.a.name.isEmpty()||this.match.b.name.isEmpty())&&(this.match.a.score=this.match.b.score=w.empty()),new o(this.match.a.score,this.match.b.score,this.matchUserData)},t}(),n=function(t){return void 0===t?null:t},h=function(t){return t.map(function(t){return t.map(function(t){return t.map(function(t){return new o(w.of(n(t[0])),w.of(n(t[1])),t[2])})})})},F=function(s){var a,c,h,t,e,n,u=new O,l=s.init,r=l.results.length<=1,i=45*l.teams.length+l.teams.length*s.matchMargin,d=C('<div class="jQBracket '+s.dir+'"></div>').appendTo(s.el.empty());function p(){var t=function(t,e,n,r,i){if(e)return Math.log(2*t)/Math.log(2);if(n)return Math.max(2,2*(Math.log(2*t)/Math.log(2)-1)-1);var o=!r&&3===i.length&&2===i[2].length;return 2*(Math.log(2*t)/Math.log(2)-1)+1+(o?1:0)}(l.teams.length,r,s.skipGrandFinalComeback,s.skipSecondaryFinal,l.results);d.css({height:r&&l.teams.length<=2&&!s.skipConsolationRound?i+40:"",width:s.disableToolbar?t*(s.teamWidth+s.scoreWidth+s.roundMargin)+10:t*(s.teamWidth+s.scoreWidth+s.roundMargin)+40})}function f(t){var n,e,r,i,o;u.reset(),a.render(),c&&c.render(),h&&!s.skipGrandFinalComeback&&h.render(),s.disableHighlight||(n=d,e=a,i=(r=h||e).winner(),o=r.loser(),i&&o&&(i.name.isEmpty()||m(i.seed.get(),"highlightWinner",n).highlight(),o.name.isEmpty()||m(o.seed.get(),"highlightLoser",n).highlight()),n.find(".team").mouseover(function(){var t=C(this).attr("data-teamid");if(void 0!==t){var e=m(parseInt(t,10),null,n);e.highlight(),C(this).mouseout(function(){e.deHighlight(),C(this).unbind("mouseout")})}})),t&&(l.results[0]=a.results(),c&&(l.results[1]=c.results()),h&&!s.skipGrandFinalComeback&&(l.results[2]=h.results()),p(),s.save&&s.save(B(l),s.userData))}s.skipSecondaryFinal&&r&&C.error("skipSecondaryFinal setting is viable only in double elimination mode"),s.disableToolbar||d.append(function(e,n){var r=e.teams.length,t=e.results.length,i=C('<div class="tools"></div>');i.append((s=function(){for(var t=0;t<r;t+=1)e.teams.push([w.empty(),w.empty()]);return F(n)},C('<span class="increment">+</span>').click(s))),(1<r&&1===t||2<r&&3===t)&&i.append((o=function(){if(1<r)return e.teams=e.teams.slice(0,r/2),F(n)},C('<span class="decrement">-</span>').click(o)));var o;var s;1===t&&1<r?i.append((c=function(){if(1<r&&t<3)return e.results.push([],[]),F(n)},C('<span class="doubleElimination">de</span>').click(c))):3===t&&1<r&&i.append((a=function(){if(3===t)return e.results=e.results.slice(0,1),F(n)},C('<span class="singleElimination">se</span>').click(a)));var a;var c;return i}(l,s)),r?e=C('<div class="bracket"></div>').appendTo(d):(s.skipGrandFinalComeback||(t=C('<div class="finals"></div>').appendTo(d)),e=C('<div class="bracket"></div>').appendTo(d),n=C('<div class="loserBracket"></div>').appendTo(d)),e.css({height:i}),n&&n.css({height:i/2}),p();var o=function(t,e,n,r,i,o,s){return new D(t,e,n,r,i,o,s,u,d,f)};return a=new N(e,w.of(l.results[0]||null),o,!0,s),r||(c=new N(n,w.of(l.results[1]||null),o,!1,s),s.skipGrandFinalComeback||(h=new N(t,w.of(l.results[2]||null),o,!1,s))),function(r,t,e,i,n){for(var o,s=Math.log(2*t.length)/Math.log(2),a=t.length,c=0;c<s;c+=1){o=r.addRound(w.empty());for(var h=0;h<a;h+=1){var u=0===c?b(t,h):null;if(c===s-1&&e||c===s-1&&n){var l=o.addMatch(u,w.of(g));n||l.setAlignCb(y(l,i.skipConsolationRound))}else o.addMatch(u,w.empty())}a/=2}if(e&&(r.final().setConnectorCb(w.empty()),1<t.length&&!i.skipConsolationRound)){var d=r.final().getRound().prev(),p=d.map(function(t){return function(){return t.match(0).loser()}}).toNull(),f=d.map(function(t){return function(){return t.match(1).loser()}}).toNull(),m=o.addMatch(function(){return[{source:p},{source:f}]},w.of(v));m.setAlignCb(function(t){var e=r.el.height()/2;m.el.css({height:e});var n=t.height()/2+i.matchMargin;t.css({top:n})}),m.setConnectorCb(w.empty())}}(a,l.teams,r,s,s.skipGrandFinalComeback&&!r),r||(function(t,e,n,r,i){for(var o=Math.log(2*n)/Math.log(2)-1,s=n/2,a=0;a<o;a+=1){for(var c=r&&a===o-1?1:2,h=0;h<c;h+=1)for(var u=e.addRound(w.empty()),l=0;l<s;l+=1){var d=h%2!=0||0===a?T(t,e,s,l,h,a):null,p=a===o-1&&r,f=u.addMatch(d,w.of(p?v:null));if(f.setAlignCb(M(f.el.find(".teamContainer"),f)),p)f.setConnectorCb(w.empty());else if(a<o-1||h<1){var m=h%2==0?R(i):null;f.setConnectorCb(w.of(m))}}s/=2}}(a,c,l.teams.length,s.skipGrandFinalComeback,s.centerConnectors),s.skipGrandFinalComeback||function(i,s,a,c,o){var t=i.addRound(w.empty()),r=t.addMatch(function(){return[{source:function(){return s.winner()}},{source:function(){return a.winner()}}]},w.of(function(e){var n=!1;if(c.skipSecondaryFinal||e.winner().name.isEmpty()||e.winner().name!==a.winner().name){if(2===i.size())i.dropRound();else if(2<i.size())throw new Error("Unexpected number of final rounds");return g(e)}if(2===i.size())return!1;var r=i.addRound(w.of(function(){var t=!e.winner().name.isEmpty()&&e.winner().name===a.winner().name;return!1===n&&t&&(n=!0,o()),!t&&n&&(n=!1,i.dropRound(),o()),t})).addMatch(function(){return[{source:function(){return e.first()}},{source:function(){return e.second()}}]},w.of(g));return e.setConnectorCb(w.of(function(t){return{height:0,shift:t.height()/2}})),r.setConnectorCb(w.empty()),r.setAlignCb(function(t){var e=s.el.height()+a.el.height();r.el.css({height:e});var n=(s.el.height()/2+s.el.height()+a.el.height()/2)/2-t.height();t.css({top:n})}),!1}));if(r.setAlignCb(function(t){var e=(s.el.height()+a.el.height())/(c.skipConsolationRound?1:2);r.el.css({height:e});var n=(s.el.height()/2+s.el.height()+a.el.height()/2)/2-t.height();t.css({top:n})}),!c.skipConsolationRound){var e=a.final().getRound().prev(),h=t.addMatch(function(){return[{source:function(){return e.get().match(0).loser()}},{source:function(){return a.loser()}}]},w.of(v));h.setAlignCb(function(t){var e=(s.el.height()+a.el.height())/2;h.el.css({height:e});var n=(s.el.height()/2+s.el.height()+a.el.height()/2)/2+t.height()/2-e;t.css({top:n})}),r.setConnectorCb(w.empty()),h.setConnectorCb(w.empty())}s.final().setConnectorCb(w.of(function(t){var e=t.height()/4,n=(s.el.height()/2+s.el.height()+a.el.height()/2)/2-t.height()/2-s.el.height()/2,r=s.winner().order.map(function(t){return t.map({height:n+2*e,shift:e*(c.centerConnectors?2:1)},{height:n+e*(c.centerConnectors?2:0),shift:e*(c.centerConnectors?2:3)})}).orElse({height:n+e*(c.centerConnectors?2:1),shift:2*e}),i=r.height,o=r.shift;return{height:i-t.height()/2,shift:o}})),a.final().setConnectorCb(w.of(function(t){var e=t.height()/4,n=(s.el.height()/2+s.el.height()+a.el.height()/2)/2-t.height()/2-s.el.height()/2,r=a.winner().order.map(function(t){return t.map({height:n+e*(c.centerConnectors?2:0),shift:e*(c.centerConnectors?2:3)},{height:n+2*e,shift:e*(c.centerConnectors?2:1)})}).orElse({height:n+e*(c.centerConnectors?2:1),shift:2*e}),i=r.height,o=r.shift;return{height:-(i+t.height()/2),shift:-o}}))}(h,a,c,s,p)),f(!1),{data:function(){return B(s.init)}}};var u=function(t){if("boolean"!=typeof t)throw new Error("Value is not a boolean");return t},f=function(t){var e=function(t){if("number"!=typeof t)throw new Error("Value is not a number");return t}(t);if(e<t)throw new Error("Value must be greater than "+t+", got "+e);return e},S=function(t){return t&t-1};function Y(t,e,n){var r,i={centerConnectors:!!t.hasOwnProperty("centerConnectors")&&u(t.centerConnectors),decorator:t.decorator,dir:function(t){{if(void 0===t)return"lr";if("lr"!==t&&"rl"!==t)throw new Error('Direction must be either: "lr" or "rl"');return t}}(t.dir),disableHighlight:!!t.hasOwnProperty("disableHighlight")&&u(t.disableHighlight),disableTeamEdit:!!t.hasOwnProperty("disableTeamEdit")&&u(t.disableTeamEdit),disableToolbar:t.disableToolbar,el:e,extension:n,init:function(t){var e=t||{results:[],teams:[[null,null]]};if(void 0===e.teams)throw new Error("Teams missing");if(void 0===e.results)throw new Error("Results missing");var n=S(e.teams.length);n!==Math.floor(n)&&C.error('"teams" property must have 2^n number of team pairs, i.e. 1, 2, 4, etc. Got '+e.teams.length+" team pairs.");var r=function t(e,n){return 0<n&&(e=t([e],n-1)),e}(e.results,4-(i=e.results,function t(e,n){return e instanceof Array?t(e[0],n+1):n}(i,0)));var i;return{results:h(r),teams:e.teams&&0!==e.teams.length?e.teams.map(function(t){return t.map(function(t){return null===t?w.empty():w.of(t)})}):[[w.empty(),w.empty()]]}}(t.init),matchMargin:t.hasOwnProperty("matchMargin")?f(t.matchMargin):20,onMatchClick:t.onMatchClick?t.onMatchClick:function(){},onMatchHover:t.onMatchHover?t.onMatchHover:function(){},roundMargin:t.hasOwnProperty("roundMargin")?f(t.roundMargin):40,save:t.save,scoreWidth:t.hasOwnProperty("scoreWidth")?f(t.scoreWidth):30,skipConsolationRound:t.skipConsolationRound||!1,skipGrandFinalComeback:t.skipGrandFinalComeback||!1,skipSecondaryFinal:t.skipSecondaryFinal||!1,teamWidth:t.hasOwnProperty("teamWidth")?f(t.teamWidth):70,userData:t.userData};return!(r=i).save&&r.disableTeamEdit&&C.error('disableTeamEdit can be used only if the bracket is editable, i.e. "save" callback given'),!r.disableToolbar&&r.disableTeamEdit&&C.error('disableTeamEdit requires also resizing to be disabled, initialize with "disableToolbar: true"'),i}function _(t,e){return t&&k(t)||k(e)?k(t)?parseInt(t,10):null:0}C.fn.bracket=function(t){var e;if("string"==typeof t&&"data"===t)return C(this).data("bracket").obj.data();if("object"==typeof(e=t)||void 0===e){var n=t;return function(t,e,n){if(!e)throw Error("Options not set");if(!e.init&&!e.save)throw Error("No bracket data or save callback given");var r=C.extend(!0,{},e);if(r.decorator&&(!r.decorator.edit||!r.decorator.render))throw Error("Invalid decorator input");r.save&&(r.onMatchClick||r.onMatchHover)&&C.error("Match callbacks may not be passed in edit mode (in conjunction with save callback)");var i=typeof r.disableToolbar,o=r.hasOwnProperty("disableToolbar");o&&"boolean"!==i&&C.error("disableToolbar must be a boolean, got "+i),!r.save&&o&&C.error('disableToolbar can be used only if the bracket is editable, i.e. "save" callback given'),o||(r.disableToolbar=void 0===r.save);var s=Y(e,t,n),a=F(s);return C(t).data("bracket",{target:t,obj:a}),null}(this,__assign({},n,{decorator:n.decorator?n.decorator:{edit:r,render:i}}),{evaluateScore:_,scoreToString:function(t){return null===t?"--":t.toString()}})}C.error("Method "+t+" does not exist on jQuery.bracket")}}(jQuery);